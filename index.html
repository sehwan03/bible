<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>성경 암송 검사기</title>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; background: #f9f9f9; }
  h1 { color: #2c3e50; margin-bottom: 20px; }
  textarea { width: 100%; height: 150px; margin-bottom: 10px; font-size: 16px; }
  button { padding: 10px 20px; font-size: 16px; margin-right: 10px; cursor: pointer; }
  .result { margin-top: 20px; font-size: 18px; line-height: 1.8; }
  .correct { color: green; }
  .incorrect { color: red; }
  .verse { margin-bottom: 20px; scroll-margin-top: 120px; }
  .word { margin-right: 2px; }
  .label.correct-label { color: blue; font-weight: bold; margin-left: 5px; }
  .label.incorrect-label { color: red; font-weight: bold; margin-left: 5px; }
  .pass { color: green; font-weight: bold; margin-left: 10px; }
  .fail { color: red; font-weight: bold; margin-left: 10px; }
</style>
</head>
<body>

<h1>성경 암송 검사기 <span id="passMark"></span></h1>
<p>암송한 구절을 입력하면 단어 단위로 맞춘 부분은 초록색, 틀린 단어는 빨강색, 구절 전체가 맞으면 <strong>(정답)</strong>, 틀리면 <strong>(오답)</strong> 표시됩니다.</p>

<textarea id="userInput" placeholder="암송한 구절을 붙여 넣으세요..."></textarea><br>
<button onclick="checkVerses()">검사하기</button>
<button onclick="resetTest()">초기화</button>

<div class="result" id="result"></div>

<script>
const verses = {
  "히브리서 4:16": ["그러므로 우리는 긍휼하심을 받고 때를 따라 돕는 은혜를 얻기 위하여 은혜의 보좌 앞에 담대히 나아갈 것이니라"],
  "예레미야 애가 3:22-23": ["여호와의 인자와 긍휼이 무궁하시므로 우리가 진멸되지 아니함이니이다", "이것들이 아침마다 새로우니 주의 성실하심이 크시도소이다"],
  "로마서 1:16": ["내가 복음을 부끄러워하지 아니하노니 이 복음은 모든 믿는 자에게 구원을 주시는 하나님의 능력이 됨이라<br>먼저는 유대인에게요 그리고 헬라인에게로다"],
  "디모데후서 3:16": ["모든 성경은 하나님의 감동으로 된 것으로 교훈과 책망과 바르게 함과 의로 교육하기에 유익하니"],
  "빌립보서 4:6-7": ["아무것도 염려하지 말고 다만 모든 일에 기도와 간구로 너희 구할 것을 감사함으로 하나님께 아뢰라", "그리하면 모든 지각에 뛰어난 하나님의 평강이 그리스도 예수 안에서 너희 마음과 생각을 지키시리라"],
  "로마서 11:36": ["이는 만물이 주에게서 나오고 주로 말미암고 주에게로 돌아감이라<br>그에게 영광이 세세에 있을지어다 아멘"],
  "예레미야 31:3": ["내가 영원한 사랑으로 너를 사랑하기에 인자함으로 너를 이끌었다 하였노라"],
  "히브리서 4:15": ["우리에게 있는 대제사장은 우리의 연약함을 동정하지 못하실 이가 아니요<br>모든 일에 우리와 똑같이 시험을 받으신 이로되 죄는 없으시니라"],
  "요한복음 14:6": ["예수께서 이르시되 내가 곧 길이요 진리요 생명이니 나로 말미암지 않고는 아버지께로 올 자가 없느니라"],
  "로마서 5:12": ["그러므로 한 사람으로 말미암아 죄가 세상에 들어오고 죄로 말미암아 사망이 들어왔나니<br>이와같이 모든 사람이 죄를 지었으므로 사망이 모든 사람에게 이르렀느니라"],
  "히브리서 9:27": ["한 번 죽는 것은 사람에게 정해진 것이요 그 후에는 심판이 있으리니"],
  "로마서 5:8": ["우리가 아직 죄인 되었을 때에 그리스도께서 우리를 위하여 죽으심으로 하나님께서 우리에 대한 자기의 사랑을 확증하셨느니라"],
  "갈라디아서 2:20": ["내가 그리스도와 함께 십자가에 못 박혔나니 그런즉 이제는 내가 사는 것이 아니요 오직 내 안에 그리스도께서 사시는 것이라<br>이제 내가 육체 가운데 사는 것은 나를 사랑하사 나를 위하여 자기 자신을 버리신 하나님의 아들을 믿는 믿음 안에서 사는 것이라"],
  "사도행전 2:38": ["베드로가 이르되 너희가 회개하여 각각 예수 그리스도의 이름으로 세례를 받고 죄 사함을 받으라<br>그리하면 성령의 선물을 받으리니"],
  "에베소서 2:8-9": ["너희는 그 은혜에 의하여 믿음으로 말미암아 구원을 받았으니 이것은 너희에게서 난 것이 아니요 하나님의 선물이라", "행위에서 난 것이 아니니 이는 누구든지 자랑하지 못하게 함이라"],
  "마태복음 7:24": ["그러므로 누구든지 나의 이 말을 듣고 행하는 자는 그 집을 반석 위에 지은 지혜로운 사람 같으리니"],
  "누가복음 6:45": ["선한 사람은 마음에 쌓은 선에서 선을 내고 악한 자는 그 쌓은 악에서 악을 내나니 이는 마음에 가득한 것을 입으로 말함이니라"],
  "고린도전서 6:19-20": ["너희 몸은 너희가 하나님께로부터 받은 바 너희 가운데 계신 성령의 전인 줄을 알지 못하느냐 너희는 너희 자신의 것이 아니라", "값으로 산 것이 되었으니 그런즉 너희 몸으로 하나님께 영광을 돌리라"],
  "로마서 14:7-8": ["우리 중에 누구든지 자기를 위하여 사는 자가 없고 자기를 위하여 죽는 자도 없도다", "우리가 살아도 주를 위하여 살고 죽어도 주를 위하여 죽나니 그러므로 사나 죽으나 우리가 주의 것이로다"],
  "요한계시록 3:20": ["볼지어다 내가 문 밖에 서서 두드리노니 누구든지 내 음성을 듣고 문을 열면 내가 그에게로 들어가 그와 더불어 먹고 그는 나와 더불어 먹으리라"],
  "요한복음 13:34-35": ["새 계명을 너희에게 주노니 서로 사랑하라 내가 너희를 사랑한 것 같이 너희도 서로 사랑하라", "너희가 서로 사랑하면 이로써 모든 사람이 너희가 내 제자인 줄 알리라"]
};

// ID 안전하게 변환
function makeSafeId(key) {
  return 'verse-' + key.replace(/[:\s]/g, '_');
}

// 공백과 <br> 제거
function cleanText(text) {
  return text.replace(/\s+/g, '').replace(/<br>/gi, '').trim();
}

function checkVerses() {
  const userInput = cleanText(document.getElementById("userInput").value);
  let resultHTML = "";
  let totalVerses = 0;
  let correctVerses = 0;

  for (const [key, sentences] of Object.entries(verses)) {
    totalVerses += sentences.length;
    const verseId = makeSafeId(key);
    resultHTML += `<div class="verse" id="${verseId}"><strong>${key}</strong>:<br>`;

    sentences.forEach(sentence => {
      const words = sentence.split(/\s+/);
      const cleanedWords = words.map(cleanText);
      const cleanedSentence = cleanText(sentence);
      const fullMatch = userInput.includes(cleanedSentence);

      if (fullMatch) correctVerses++;

      let displayHTML = "";
      words.forEach((word, idx) => {
        if (fullMatch || userInput.includes(cleanedWords[idx])) {
          displayHTML += `<span class="correct word">${word}</span> `;
        } else {
          displayHTML += `<span class="incorrect word">${word}</span> `;
        }
      });

      if (fullMatch) {
        displayHTML += `<span class="label correct-label">(정답)</span>`;
      } else {
        displayHTML += `<span class="label incorrect-label">(오답)</span>`;
      }

      resultHTML += displayHTML + "<br>";
    });

    resultHTML += "</div>";
  }

  document.getElementById("result").innerHTML = resultHTML;

  // 점수 표시
  const passMark = document.getElementById("passMark");
  if (correctVerses === totalVerses) {
    passMark.innerHTML = `<span class="pass">통과</span>`;
  } else {
    passMark.innerHTML = `<span class="fail">점수: ${correctVerses} / ${totalVerses}</span>`;
  }

  // 첫 오답 구절 스크롤
  const firstWrong = document.querySelector(".verse .label.incorrect-label")?.closest(".verse");
  if (firstWrong) firstWrong.scrollIntoView({ behavior: "smooth", block: "center" });
}

function resetTest() {
  document.getElementById("userInput").value = '';
  document.getElementById("result").innerHTML = '';
  document.getElementById("passMark").innerHTML = '';
}
</script>

</body>
</html>
